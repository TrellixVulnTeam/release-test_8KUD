/* eslint @typescript-eslint/no-var-requires: "off" */
const { DefinePlugin } = require('webpack');
const MinifyPlugin = require('babel-minify-webpack-plugin');
const CompressionPlugin = require('compression-webpack-plugin');
const env = require('../envs');

module.exports = (minimize) =>
  (env.__PROD__ && minimize
    ? ({
      plugins: [
        new MinifyPlugin(undefined, { comments: false, sourceMap: true }),
        new CompressionPlugin({ algorithm: 'gzip', cache: false }),
        new DefinePlugin({
          __REACT_DEVTOOLS_GLOBAL_HOOK__: '({ isDisabled: true })',
        }),
      ],
    }) : ({}));
