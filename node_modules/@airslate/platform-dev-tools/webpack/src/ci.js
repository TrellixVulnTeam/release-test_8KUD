/* eslint @typescript-eslint/no-var-requires: "off" */
const { merge } = require('webpack-merge');
const env = require('./envs');
const subconfigs = require('./subconfigs');

module.exports = (appName, bundles, {
  minimize = true,
  assetsOptions = {},
  babelrc,
  repo,
} = {}) => merge(
  subconfigs.mode(),
  subconfigs.io(env.BUNDLES || bundles, appName),
  subconfigs.babelLoader(babelrc),
  subconfigs.svgLoader(),
  subconfigs.define({ appName }),
  subconfigs.devTools(appName),
  subconfigs.vendors(),
  subconfigs.minify(minimize),
  subconfigs.assets(assetsOptions),
  subconfigs.sentry(env.RELEASE, appName, env.BUILD_NUMBER, repo),
  subconfigs.platformSDKConfig({ appName }),
  subconfigs.platformSDK(),
  subconfigs.optimizations(),
);
