/* eslint-disable no-underscore-dangle */
/* eslint-disable prefer-destructuring */
/* eslint @typescript-eslint/no-var-requires: "off" */
const path = require('path');

const LOCAL = 'local';
const DEV = 'development';
const PROD = 'production';

const TARGET = process.env.TARGET || LOCAL;
const __LOCAL__ = TARGET === LOCAL;
const __CI__ = !__LOCAL__;

const BRANCH = process.env.BRANCH || 'unknown';
const TRIGGERED_BY = process.env.TRIGGERED_BY || 'unknown';
const BUILD_NUMBER = process.env.BUILD_NUMBER || '0';

// Sentry does not allow slashes, dots & whitespaces. Invalid release tag causes build failure.
const RELEASE = `${BRANCH}@${BUILD_NUMBER}`.replace(/[/\\.\s]/g, '-');

const CDN = process.env.CDN || (__LOCAL__ && 'https://my.airslate.localhost:1900') || '';
const SOURCEMAP_CDN = process.env.SOURCEMAP_CDN || '';
const MOUNT_PATH = __LOCAL__ ? '/' : process.env.MOUNT_PATH || '/';

const BUILD_FOLDER = './build';
const PUBLIC_FOLDER = './public';

const NODE_ENV = process.env.NODE_ENV || DEV;
const BUNDLES = process.env.BUNDLES || '';
const APP_FOLDER = process.cwd();
const __DEV__ = NODE_ENV === DEV;
const __PROD__ = NODE_ENV === PROD;

const NO_PROGRESS = process.env.NO_PROGRESS;
const ANALYZE = process.env.ANALYZE;

const DIST_FOLDER = path.join(APP_FOLDER, PUBLIC_FOLDER);

module.exports = {
  LOCAL,
  DEV,
  PROD,

  TARGET,
  __LOCAL__,
  __CI__,

  BRANCH,
  TRIGGERED_BY,
  BUILD_NUMBER,
  RELEASE,
  CDN,
  SOURCEMAP_CDN,
  MOUNT_PATH,

  BUILD_FOLDER,
  PUBLIC_FOLDER,

  NODE_ENV,
  __DEV__,
  __PROD__,
  BUNDLES,
  APP_FOLDER,
  DIST_FOLDER,

  NO_PROGRESS,
  ANALYZE,
};
